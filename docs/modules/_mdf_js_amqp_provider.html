<!DOCTYPE html><html class="default" lang="en"><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>@mdf.js/amqp-provider | @mdf.js</title><meta name="description" content="Documentation for @mdf.js"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script defer src="../assets/main.js"></script><script async src="../assets/icons.js" id="tsd-icons-script"></script><script async src="../assets/search.js" id="tsd-search-script"></script><script async src="../assets/navigation.js" id="tsd-nav-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search" data-base=".."><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="../assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">@mdf.js</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb"><li><a href="../index.html">@mdf.js</a></li><li><a href="_mdf_js_amqp_provider.html">@mdf.js/amqp-provider</a></li></ul><h1>Module @mdf.js/amqp-provider</h1></div><section class="tsd-panel tsd-typography"><a id="md:mdfjsamqp-provider" class="tsd-anchor"></a><h1 class="tsd-anchor-link"><strong>@mdf.js/amqp-provider</strong><a href="#md:mdfjsamqp-provider" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h1><p><a href="https://nodejs.org/en/"><img src="https://img.shields.io/static/v1?style=flat&amp;logo=node.js&amp;logoColor=green&amp;label=node&amp;message=%3E=20&amp;color=blue" alt="Node Version"></a>
<a href="https://www.typescriptlang.org/"><img src="https://img.shields.io/static/v1?style=flat&amp;logo=typescript&amp;label=Typescript&amp;message=5.4&amp;color=blue" alt="Typescript Version"></a>
<a href="https://snyk.io/package/npm/snyk"><img src="https://img.shields.io/static/v1?style=flat&amp;logo=snyk&amp;label=Vulnerabilities&amp;message=0&amp;color=300A98F" alt="Known Vulnerabilities"></a></p>
<!-- markdownlint-disable MD033 MD041 -->
<p align="center">
  <div style="text-align:center;background-image:radial-gradient(circle farthest-corner at 50% 50%, #104c60, #0c0c13);">
    <img src="https://assets.website-files.com/626a3ef32d23835d9b2e4532/6290ab1e2d3e0d922913a6e3_digitalizacion_ENG.svg"alt="netin"width="500">
  </div>
</p>
<h1 style="text-align:center;margin-bottom:0">Mytra Development Framework - @mdf.js/amqp-provider </h1>
<h5 style="text-align:center;margin-top:0">Typescript tools for development</h5>
<!-- markdownlint-enable MD033 -->
<hr>
<a id="md:table-of-contents" class="tsd-anchor"></a><h2 class="tsd-anchor-link"><strong>Table of contents</strong><a href="#md:table-of-contents" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li><a href="#md:mdfjsamqp-provider"><strong>@mdf.js/amqp-provider</strong></a>
<ul>
<li><a href="#md:table-of-contents"><strong>Table of contents</strong></a></li>
<li><a href="#md:introduction"><strong>Introduction</strong></a></li>
<li><a href="#md:installation"><strong>Installation</strong></a></li>
<li><a href="#md:information"><strong>Information</strong></a></li>
<li><a href="#md:use"><strong>Use</strong></a>
<ul>
<li><a href="#md:health-checks"><strong>Health checks</strong></a></li>
</ul>
</li>
<li><a href="#md:environment-variables"><strong>Environment variables</strong></a></li>
<li><a href="#md:license"><strong>License</strong></a></li>
</ul>
</li>
</ul>
<a id="md:introduction" class="tsd-anchor"></a><h2 class="tsd-anchor-link"><strong>Introduction</strong><a href="#md:introduction" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p><a href="https://es.wikipedia.org/wiki/Advanced_Message_Queuing_Protocol">AMQP</a> provider for <a href="https://mytracontrol.github.io/mdf.js/">@mdf.js</a> based on <a href="https://www.npmjs.com/package/rhea-promise">rhea</a>.</p>
<a id="md:installation" class="tsd-anchor"></a><h2 class="tsd-anchor-link"><strong>Installation</strong><a href="#md:installation" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Using npm:</p>
<pre><code class="bash"><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">install</span><span class="hl-1"> </span><span class="hl-2">@mdf.js/amqp-provider</span>
</code><button type="button">Copy</button></pre>

<p>Using yarn:</p>
<pre><code class="bash"><span class="hl-0">yarn</span><span class="hl-1"> </span><span class="hl-2">add</span><span class="hl-1"> </span><span class="hl-2">@mdf.js/amqp-provider</span>
</code><button type="button">Copy</button></pre>

<a id="md:information" class="tsd-anchor"></a><h2 class="tsd-anchor-link"><strong>Information</strong><a href="#md:information" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Check information about <strong>@mdf.js</strong> providers in the documentation of the core module <a href="https://mytracontrol.github.io/mdf.js/modules/_mdf_js_core.html"><strong>@mdf.js/core</strong></a>.</p>
<a id="md:use" class="tsd-anchor"></a><h2 class="tsd-anchor-link"><strong>Use</strong><a href="#md:use" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>In this module there are implemented two providers:</p>
<ul>
<li>
<p>The consumer (<code>Receiver</code>), that wraps the <a href="https://www.npmjs.com/package/rhea-promise">rhea-promise</a> <code>Receiver</code>, which wraps the <a href="https://www.npmjs.com/package/rhea">rhea</a> <code>Receiver</code> class.</p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-6">Receiver</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@mdf.js/amqp-provider&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-8">ownReceiver</span><span class="hl-1"> = </span><span class="hl-6">Receiver</span><span class="hl-1">.</span><span class="hl-6">Factory</span><span class="hl-1">.</span><span class="hl-0">create</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-6">name:</span><span class="hl-1"> </span><span class="hl-2">`myAMQPReceiverName`</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-6">config:</span><span class="hl-1"> {...}, </span><span class="hl-7">//rhea - AMQP CommonConnectionOptions</span><br/><span class="hl-1">  </span><span class="hl-6">logger:</span><span class="hl-1"> </span><span class="hl-6">myLoggerInstance</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-6">useEnvironment:</span><span class="hl-1"> </span><span class="hl-4">true</span><span class="hl-1">,</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<ul>
<li>
<p><strong>Defaults</strong>:</p>
<pre><code class="typescript"><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-7">// ... Common client options, see below</span><br/><span class="hl-1">  </span><span class="hl-10">receiver_options</span><span class="hl-1">: {</span><br/><span class="hl-1">    </span><span class="hl-10">name</span><span class="hl-1">: </span><span class="hl-6">process</span><span class="hl-1">.</span><span class="hl-6">env</span><span class="hl-1">[</span><span class="hl-2">&#39;NODE_APP_INSTANCE&#39;</span><span class="hl-1">] ||</span><span class="hl-2">&#39;mdf-amqp&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-10">rcv_settle_mode</span><span class="hl-1">: </span><span class="hl-9">0</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-10">credit_window</span><span class="hl-1">: </span><span class="hl-9">0</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-10">autoaccept</span><span class="hl-1">: </span><span class="hl-4">false</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-10">autosettle</span><span class="hl-1">: </span><span class="hl-4">true</span><span class="hl-1">,</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

</li>
<li>
<p><strong>Environment</strong>: remember to set the <code>useEnvironment</code> flag to <code>true</code> to use these environment variables.</p>
<pre><code class="typescript"><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-7">// ... Common client options, see below</span><br/><span class="hl-1">  </span><span class="hl-10">receiver_options</span><span class="hl-1">: {</span><br/><span class="hl-1">    </span><span class="hl-10">name</span><span class="hl-1">: </span><span class="hl-6">process</span><span class="hl-1">.</span><span class="hl-6">env</span><span class="hl-1">[</span><span class="hl-2">&#39;CONFIG_AMQP_RECEIVER_NAME&#39;</span><span class="hl-1">],</span><br/><span class="hl-1">    </span><span class="hl-10">rcv_settle_mode</span><span class="hl-1">: </span><span class="hl-6">process</span><span class="hl-1">.</span><span class="hl-6">env</span><span class="hl-1">[</span><span class="hl-2">&#39;CONFIG_AMQP_RECEIVER_SETTLE_MODE&#39;</span><span class="hl-1">], </span><span class="hl-7">// coerced to number</span><br/><span class="hl-1">    </span><span class="hl-10">credit_window</span><span class="hl-1">: </span><span class="hl-6">process</span><span class="hl-1">.</span><span class="hl-6">env</span><span class="hl-1">[</span><span class="hl-2">&#39;CONFIG_AMQP_RECEIVER_CREDIT_WINDOW&#39;</span><span class="hl-1">], </span><span class="hl-7">// coerced to number</span><br/><span class="hl-1">    </span><span class="hl-10">autoaccept</span><span class="hl-1">: </span><span class="hl-6">process</span><span class="hl-1">.</span><span class="hl-6">env</span><span class="hl-1">[</span><span class="hl-2">&#39;CONFIG_AMQP_RECEIVER_AUTO_ACCEPT&#39;</span><span class="hl-1">], </span><span class="hl-7">// coerced to boolean</span><br/><span class="hl-1">    </span><span class="hl-10">autosettle</span><span class="hl-1">: </span><span class="hl-6">process</span><span class="hl-1">.</span><span class="hl-6">env</span><span class="hl-1">[</span><span class="hl-2">&#39;CONFIG_AMQP_RECEIVER_AUTO_SETTLE&#39;</span><span class="hl-1">], </span><span class="hl-7">// coerced to boolean</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

</li>
</ul>
</li>
<li>
<p>The producer (<code>Sender</code>) that wraps the <a href="https://www.npmjs.com/package/rhea-promise">rhea-promise</a> <code>AwaitableSender</code> class.</p>
<pre><code class="typescript"><span class="hl-3">import</span><span class="hl-1"> { </span><span class="hl-6">Sender</span><span class="hl-1"> } </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;@mdf.js/amqp-provider&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-8">ownSender</span><span class="hl-1"> = </span><span class="hl-6">Sender</span><span class="hl-1">.</span><span class="hl-6">Factory</span><span class="hl-1">.</span><span class="hl-0">create</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-6">name:</span><span class="hl-1"> </span><span class="hl-2">`myAMQPSenderName`</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-6">config:</span><span class="hl-1"> {...}, </span><span class="hl-7">//rhea - AMQP CommonConnectionOptions</span><br/><span class="hl-1">  </span><span class="hl-6">logger:</span><span class="hl-1"> </span><span class="hl-6">myLoggerInstance</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-6">useEnvironment:</span><span class="hl-1"> </span><span class="hl-4">true</span><span class="hl-1">,</span><br/><span class="hl-1">});</span>
</code><button type="button">Copy</button></pre>

<ul>
<li>
<p><strong>Defaults</strong>:</p>
<pre><code class="typescript"><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-7">// ... Common client options, see below</span><br/><span class="hl-1">  </span><span class="hl-10">sender_options</span><span class="hl-1">: {</span><br/><span class="hl-1">    </span><span class="hl-10">name</span><span class="hl-1">: </span><span class="hl-6">process</span><span class="hl-1">.</span><span class="hl-6">env</span><span class="hl-1">[</span><span class="hl-2">&#39;NODE_APP_INSTANCE&#39;</span><span class="hl-1">] ||</span><span class="hl-2">&#39;mdf-amqp&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-10">snd_settle_mode</span><span class="hl-1">: </span><span class="hl-9">2</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-10">autosettle</span><span class="hl-1">: </span><span class="hl-4">true</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-10">target</span><span class="hl-1">: {},</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

</li>
<li>
<p><strong>Environment</strong>: remember to set the <code>useEnvironment</code> flag to <code>true</code> to use these environment variables.</p>
<pre><code class="typescript"><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-7">// ... Common client options, see below</span><br/><span class="hl-1">  </span><span class="hl-10">sender_options</span><span class="hl-1">: {</span><br/><span class="hl-1">    </span><span class="hl-10">name</span><span class="hl-1">: </span><span class="hl-6">process</span><span class="hl-1">.</span><span class="hl-6">env</span><span class="hl-1">[</span><span class="hl-2">&#39;CONFIG_AMQP_SENDER_NAME&#39;</span><span class="hl-1">],</span><br/><span class="hl-1">    </span><span class="hl-10">snd_settle_mode</span><span class="hl-1">: </span><span class="hl-6">process</span><span class="hl-1">.</span><span class="hl-6">env</span><span class="hl-1">[</span><span class="hl-2">&#39;CONFIG_AMQP_SENDER_SETTLE_MODE&#39;</span><span class="hl-1">], </span><span class="hl-7">// coerced to number</span><br/><span class="hl-1">    </span><span class="hl-10">autosettle</span><span class="hl-1">: </span><span class="hl-6">process</span><span class="hl-1">.</span><span class="hl-6">env</span><span class="hl-1">[</span><span class="hl-2">&#39;CONFIG_AMQP_SENDER_AUTO_SETTLE&#39;</span><span class="hl-1">], </span><span class="hl-7">// coerced to boolean</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

</li>
</ul>
</li>
<li>
<p>Common client options:</p>
<ul>
<li>
<p><strong>Defaults</strong>:</p>
<pre><code class="typescript"><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-10">username</span><span class="hl-1">: </span><span class="hl-2">&#39;mdf-amqp&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-10">host</span><span class="hl-1">: </span><span class="hl-2">&#39;127.0.0.1&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-10">port</span><span class="hl-1">: </span><span class="hl-9">5672</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-10">transport</span><span class="hl-1">: </span><span class="hl-2">&#39;tcp&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-10">container_id</span><span class="hl-1">: </span><span class="hl-6">process</span><span class="hl-1">.</span><span class="hl-6">env</span><span class="hl-1">[</span><span class="hl-2">&#39;NODE_APP_INSTANCE&#39;</span><span class="hl-1">] || </span><span class="hl-2">&#39;mdf-amqp&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-10">reconnect</span><span class="hl-1">: </span><span class="hl-9">5000</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-10">initial_reconnect_delay</span><span class="hl-1">: </span><span class="hl-9">30000</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-10">max_reconnect_delay</span><span class="hl-1">: </span><span class="hl-9">10000</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-10">non_fatal_errors</span><span class="hl-1">: [</span><span class="hl-2">&#39;amqp:connection:forced&#39;</span><span class="hl-1">],</span><br/><span class="hl-1">  </span><span class="hl-10">idle_time_out</span><span class="hl-1">: </span><span class="hl-9">5000</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-10">reconnect_limit</span><span class="hl-1">: </span><span class="hl-6">Number</span><span class="hl-1">.MAX_SAFE_INTEGER,</span><br/><span class="hl-1">  </span><span class="hl-10">keepAlive</span><span class="hl-1">: </span><span class="hl-4">true</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-10">keepAliveInitialDelay</span><span class="hl-1">: </span><span class="hl-9">2000</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-10">timeout</span><span class="hl-1">: </span><span class="hl-9">10000</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-10">all_errors_non_fatal</span><span class="hl-1">: </span><span class="hl-4">true</span><span class="hl-1">,</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

</li>
<li>
<p><strong>Environment</strong>: remember to set the <code>useEnvironment</code> flag to <code>true</code> to use these environment variables.</p>
<pre><code class="typescript"><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-10">username</span><span class="hl-1">: </span><span class="hl-6">process</span><span class="hl-1">.</span><span class="hl-6">env</span><span class="hl-1">[</span><span class="hl-2">&#39;CONFIG_AMQP_USER_NAME&#39;</span><span class="hl-1">],</span><br/><span class="hl-1">  </span><span class="hl-10">password</span><span class="hl-1">: </span><span class="hl-6">process</span><span class="hl-1">.</span><span class="hl-6">env</span><span class="hl-1">[</span><span class="hl-2">&#39;CONFIG_AMQP_PASSWORD&#39;</span><span class="hl-1">],</span><br/><span class="hl-1">  </span><span class="hl-10">host</span><span class="hl-1">: </span><span class="hl-6">process</span><span class="hl-1">.</span><span class="hl-6">env</span><span class="hl-1">[</span><span class="hl-2">&#39;CONFIG_AMQP_HOST&#39;</span><span class="hl-1">],</span><br/><span class="hl-1">  </span><span class="hl-10">hostname</span><span class="hl-1">: </span><span class="hl-6">process</span><span class="hl-1">.</span><span class="hl-6">env</span><span class="hl-1">[</span><span class="hl-2">&#39;CONFIG_AMQP_HOSTNAME&#39;</span><span class="hl-1">],</span><br/><span class="hl-1">  </span><span class="hl-10">port</span><span class="hl-1">: </span><span class="hl-6">process</span><span class="hl-1">.</span><span class="hl-6">env</span><span class="hl-1">[</span><span class="hl-2">&#39;CONFIG_AMQP_PORT&#39;</span><span class="hl-1">], </span><span class="hl-7">// coerced to number</span><br/><span class="hl-1">  </span><span class="hl-10">transport</span><span class="hl-1">: </span><span class="hl-6">process</span><span class="hl-1">.</span><span class="hl-6">env</span><span class="hl-1">[</span><span class="hl-2">&#39;CONFIG_AMQP_TRANSPORT&#39;</span><span class="hl-1">],</span><br/><span class="hl-1">  </span><span class="hl-10">container_id</span><span class="hl-1">: </span><span class="hl-6">process</span><span class="hl-1">.</span><span class="hl-6">env</span><span class="hl-1">[</span><span class="hl-2">&#39;CONFIG_AMQP_CONTAINER_ID&#39;</span><span class="hl-1">],</span><br/><span class="hl-1">  </span><span class="hl-10">id</span><span class="hl-1">: </span><span class="hl-6">process</span><span class="hl-1">.</span><span class="hl-6">env</span><span class="hl-1">[</span><span class="hl-2">&#39;CONFIG_AMQP_ID&#39;</span><span class="hl-1">],</span><br/><span class="hl-1">  </span><span class="hl-10">reconnect</span><span class="hl-1">: </span><span class="hl-6">process</span><span class="hl-1">.</span><span class="hl-6">env</span><span class="hl-1">[</span><span class="hl-2">&#39;CONFIG_AMQP_RECONNECT&#39;</span><span class="hl-1">], </span><span class="hl-7">// coerced to number</span><br/><span class="hl-1">  </span><span class="hl-10">reconnect_limit</span><span class="hl-1">: </span><span class="hl-6">process</span><span class="hl-1">.</span><span class="hl-6">env</span><span class="hl-1">[</span><span class="hl-2">&#39;CONFIG_AMQP_RECONNECT_LIMIT&#39;</span><span class="hl-1">], </span><span class="hl-7">// coerced to number</span><br/><span class="hl-1">  </span><span class="hl-10">initial_reconnect_delay</span><span class="hl-1">: </span><span class="hl-6">process</span><span class="hl-1">.</span><span class="hl-6">env</span><span class="hl-1">[</span><span class="hl-2">&#39;CONFIG_AMQP_INITIAL_RECONNECT_DELAY&#39;</span><span class="hl-1">], </span><span class="hl-7">// coerced to number</span><br/><span class="hl-1">  </span><span class="hl-10">max_reconnect_delay</span><span class="hl-1">: </span><span class="hl-6">process</span><span class="hl-1">.</span><span class="hl-6">env</span><span class="hl-1">[</span><span class="hl-2">&#39;CONFIG_AMQP_MAX_RECONNECT_DELAY&#39;</span><span class="hl-1">], </span><span class="hl-7">// coerced to number</span><br/><span class="hl-1">  </span><span class="hl-10">max_frame_size</span><span class="hl-1">: </span><span class="hl-6">process</span><span class="hl-1">.</span><span class="hl-6">env</span><span class="hl-1">[</span><span class="hl-2">&#39;CONFIG_AMQP_MAX_FRAME_SIZE&#39;</span><span class="hl-1">], </span><span class="hl-7">// coerced to number</span><br/><span class="hl-1">  </span><span class="hl-10">non_fatal_errors</span><span class="hl-1">: </span><span class="hl-6">process</span><span class="hl-1">.</span><span class="hl-6">env</span><span class="hl-1">[</span><span class="hl-2">&#39;CONFIG_AMQP_NON_FATAL_ERRORS&#39;</span><span class="hl-1">], </span><span class="hl-7">// coerced to array from string separated by &#39;,&#39;</span><br/><span class="hl-1">  </span><span class="hl-10">key</span><span class="hl-1">: </span><span class="hl-6">process</span><span class="hl-1">.</span><span class="hl-6">env</span><span class="hl-1">[</span><span class="hl-2">&#39;CONFIG_AMQP_CLIENT_KEY_PATH&#39;</span><span class="hl-1">], </span><span class="hl-7">// The file will be read and the content will be used as the key</span><br/><span class="hl-1">  </span><span class="hl-10">cert</span><span class="hl-1">: </span><span class="hl-6">process</span><span class="hl-1">.</span><span class="hl-6">env</span><span class="hl-1">[</span><span class="hl-2">&#39;CONFIG_AMQP_CLIENT_CERT_PATH&#39;</span><span class="hl-1">], </span><span class="hl-7">// The file will be read and the content will be used as the cert</span><br/><span class="hl-1">  </span><span class="hl-10">ca</span><span class="hl-1">: </span><span class="hl-6">process</span><span class="hl-1">.</span><span class="hl-6">env</span><span class="hl-1">[</span><span class="hl-2">&#39;CONFIG_AMQP_CA_PATH&#39;</span><span class="hl-1">], </span><span class="hl-7">// The file will be read and the content will be used as the CA</span><br/><span class="hl-1">  </span><span class="hl-10">requestCert</span><span class="hl-1">: </span><span class="hl-6">process</span><span class="hl-1">.</span><span class="hl-6">env</span><span class="hl-1">[</span><span class="hl-2">&#39;CONFIG_AMQP_REQUEST_CERT&#39;</span><span class="hl-1">], </span><span class="hl-7">// coerced to boolean</span><br/><span class="hl-1">  </span><span class="hl-10">rejectUnauthorized</span><span class="hl-1">: </span><span class="hl-6">process</span><span class="hl-1">.</span><span class="hl-6">env</span><span class="hl-1">[</span><span class="hl-2">&#39;CONFIG_AMQP_REJECT_UNAUTHORIZED&#39;</span><span class="hl-1">], </span><span class="hl-7">// coerced to boolean</span><br/><span class="hl-1">  </span><span class="hl-10">idle_time_out</span><span class="hl-1">: </span><span class="hl-6">process</span><span class="hl-1">.</span><span class="hl-6">env</span><span class="hl-1">[</span><span class="hl-2">&#39;CONFIG_AMQP_IDLE_TIME_OUT&#39;</span><span class="hl-1">], </span><span class="hl-7">// coerced to number</span><br/><span class="hl-1">  </span><span class="hl-10">keepAlive</span><span class="hl-1">: </span><span class="hl-6">process</span><span class="hl-1">.</span><span class="hl-6">env</span><span class="hl-1">[</span><span class="hl-2">&#39;CONFIG_AMQP_KEEP_ALIVE&#39;</span><span class="hl-1">], </span><span class="hl-7">// coerced to boolean</span><br/><span class="hl-1">  </span><span class="hl-10">keepAliveInitialDelay</span><span class="hl-1">: </span><span class="hl-6">process</span><span class="hl-1">.</span><span class="hl-6">env</span><span class="hl-1">[</span><span class="hl-2">&#39;CONFIG_AMQP_KEEP_ALIVE_INITIAL_DELAY&#39;</span><span class="hl-1">], </span><span class="hl-7">// coerced to number</span><br/><span class="hl-1">  </span><span class="hl-10">timeout</span><span class="hl-1">: </span><span class="hl-6">process</span><span class="hl-1">.</span><span class="hl-6">env</span><span class="hl-1">[</span><span class="hl-2">&#39;CONFIG_AMQP_TIMEOUT&#39;</span><span class="hl-1">], </span><span class="hl-7">// coerced to number</span><br/><span class="hl-1">  </span><span class="hl-10">all_errors_non_fatal</span><span class="hl-1">: </span><span class="hl-6">process</span><span class="hl-1">.</span><span class="hl-6">env</span><span class="hl-1">[</span><span class="hl-2">&#39;CONFIG_AMQP_ALL_ERRORS_NON_FATAL&#39;</span><span class="hl-1">], </span><span class="hl-7">// coerced to boolean</span><br/><span class="hl-1">};</span>
</code><button type="button">Copy</button></pre>

</li>
</ul>
</li>
</ul>
<a id="md:health-checks" class="tsd-anchor"></a><h3 class="tsd-anchor-link"><strong>Health checks</strong><a href="#md:health-checks" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Checks included in the provider:</p>
<ul>
<li><strong>status</strong>: Checks the status of the AMQP connection
<ul>
<li><strong>observedValue</strong>: Actual state of the consumer/producer provider instance [<code>error</code>, <code>running</code>, <code>stopped</code>].</li>
<li><strong>status</strong>: <code>pass</code> if the status is <code>running</code>, <code>warn</code> if the status is <code>stopped</code>, <code>fail</code> if the status is <code>error</code>.</li>
<li><strong>output</strong>: in case of <code>error</code> state (status <code>fail</code>), the error message is shown.</li>
</ul>
</li>
<li><strong>credits</strong>: Checks the credits of the AMQP connection
<ul>
<li><strong>observedValue</strong>: Actual number of credits in the consumer/producer instance.</li>
<li><strong>observedUnit</strong>: <code>credits</code>.</li>
<li><strong>status</strong>: <code>pass</code> if the number of credits is greater than <code>0</code>, <code>warn</code> otherwise.</li>
<li><strong>output</strong>: <code>No credits available</code> if the number of credits is <code>0</code>.</li>
</ul>
</li>
</ul>
<pre><code class="json"><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-11">&quot;[mdf-amqp:status]&quot;</span><span class="hl-1">: [</span><br/><span class="hl-1">    {</span><br/><span class="hl-1">      </span><span class="hl-11">&quot;status&quot;</span><span class="hl-1">: </span><span class="hl-2">&quot;pass&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-11">&quot;componentId&quot;</span><span class="hl-1">: </span><span class="hl-2">&quot;00000000-0000-0000-0000-000000000000&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-11">&quot;observedValue&quot;</span><span class="hl-1">: </span><span class="hl-2">&quot;running&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-11">&quot;componentType&quot;</span><span class="hl-1">: </span><span class="hl-2">&quot;service&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-11">&quot;output&quot;</span><span class="hl-1">: </span><span class="hl-15">undefined</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  ],</span><br/><span class="hl-1">  </span><span class="hl-11">&quot;[mdf-amqp:credits]&quot;</span><span class="hl-1">: [</span><br/><span class="hl-1">    {</span><br/><span class="hl-1">      </span><span class="hl-11">&quot;status&quot;</span><span class="hl-1">: </span><span class="hl-2">&quot;pass&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-11">&quot;componentId&quot;</span><span class="hl-1">: </span><span class="hl-2">&quot;00000000-0000-0000-0000-000000000000&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-11">&quot;observedValue&quot;</span><span class="hl-1">: </span><span class="hl-9">10</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-11">&quot;observedUnit&quot;</span><span class="hl-1">: </span><span class="hl-2">&quot;credits&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-11">&quot;output&quot;</span><span class="hl-1">: </span><span class="hl-15">undefined</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  ]</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<a id="md:environment-variables" class="tsd-anchor"></a><h2 class="tsd-anchor-link"><strong>Environment variables</strong><a href="#md:environment-variables" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li><strong>CONFIG_AMQP_SENDER_NAME</strong> (default: <code>NODE_APP_INSTANCE || `mdf-amqp`</code>): The name of the link. This should be unique for the container. If not specified a unique name is generated.</li>
<li><strong>CONFIG_AMQP_SENDER_SETTLE_MODE</strong> (default: <code>2</code>): It specifies the sender settle mode with following possible values: - 0 - &quot;unsettled&quot; - The sender will send all deliveries initially unsettled to the receiver. - 1 - &quot;settled&quot; - The sender will send all deliveries settled to the receiver. - 2 - &quot;mixed&quot; - (default) The sender MAY send a mixture of settled and unsettled deliveries to the receiver.</li>
<li><strong>CONFIG_AMQP_SENDER_AUTO_SETTLE</strong> (default: <code>true</code>): Whether sent messages should be automatically settled once the peer settles them.</li>
<li><strong>CONFIG_AMQP_RECEIVER_NAME</strong> (default: <code>NODE_APP_INSTANCE || `mdf-amqp`</code>): The name of the link. This should be unique for the container. If not specified a unique name is generated.</li>
<li><strong>CONFIG_AMQP_RECEIVER_SETTLE_MODE</strong> (default: <code>0</code>): It specifies the receiver settle mode with following possible values: - 0 - &quot;first&quot; - The receiver will spontaneously settle all incoming transfers. - 1 - &quot;second&quot; - The receiver will only settle after sending the disposition to the sender and receiving a disposition indicating settlement of the delivery from the sender.</li>
<li><strong>CONFIG_AMQP_RECEIVER_CREDIT_WINDOW</strong> (default: <code>0</code>): A &quot;prefetch&quot; window controlling the flow of messages over this receiver. Defaults to <code>1000</code> if not specified. A value of <code>0</code> can be used to turn off automatic flow control and manage it directly.</li>
<li><strong>CONFIG_AMQP_RECEIVER_AUTO_ACCEPT</strong> (default: <code>false</code>): Whether received messages should be automatically accepted.</li>
<li><strong>CONFIG_AMQP_RECEIVER_AUTO_SETTLE</strong> (default: <code>true</code>): Whether received messages should be automatically settled once the remote settles them.</li>
<li><strong>CONFIG_AMQP_USER_NAME</strong> (default: <code>'mdf-amqp'</code>): User name for the AMQP connection</li>
<li><strong>CONFIG_AMQP_PASSWORD</strong> (default: <code>undefined</code>): The secret key to be used while establishing the connection</li>
<li><strong>CONFIG_AMQP_HOST</strong> (default: <code>undefined</code>): The hostname of the AMQP server</li>
<li><strong>CONFIG_AMQP_HOSTNAME</strong> (default: <code>127.0.0.1</code>): The hostname presented in <code>open</code> frame, defaults to host.</li>
<li><strong>CONFIG_AMQP_PORT</strong> (default: <code>5672</code>): The port of the AMQP server</li>
<li><strong>CONFIG_AMQP_TRANSPORT</strong> (default: <code>'tcp'</code>): The transport option. This is ignored if connection_details is set.</li>
<li><strong>NODE_APP_INSTANCE</strong> (default: <code>'tcp'</code>): The transport option. This is ignored if connection_details is set.</li>
<li><strong>CONFIG_AMQP_CONTAINER_ID</strong> (default: <code>process.env['NODE_APP_INSTANCE'] || `mdf-amqp`</code>): The id of the source container. If not provided then this will be the id (a guid string) of the assocaited container object. When this property is provided, it will be used in the <code>open</code> frame to let the peer know about the container id. However, the associated container object would still be the same container object from which the connection is being created. The <code>&quot;container\_id&quot;</code> is how the peer will identify the 'container' the connection is being established from. The container in AMQP terminology is roughly analogous to a process. Using a different container id on connections from the same process would cause the peer to treat them as coming from distinct processes.</li>
<li><strong>CONFIG_AMQP_ID</strong> (default: <code>undefined</code>): A unique name for the connection. If not provided then this will be a string in the following format: &quot;connection-&lt;counter&gt;&quot;.</li>
<li><strong>CONFIG_AMQP_RECONNECT</strong> (default: <code>5000</code>): If true (default), the library will automatically attempt to reconnect if disconnected. If false, automatic reconnect will be disabled. If it is a numeric value, it is interpreted as the delay between reconnect attempts (in milliseconds).</li>
<li><strong>CONFIG_AMQP_RECONNECT_LIMIT</strong> (default: <code>undefined</code>): Maximum number of reconnect attempts. Applicable only when reconnect is true.</li>
<li><strong>CONFIG_AMQP_INITIAL_RECONNECT_DELAY</strong> (default: <code>30000</code>): Time to wait in milliseconds before attempting to reconnect. Applicable only when reconnect is true or a number is provided for reconnect.</li>
<li><strong>CONFIG_AMQP_MAX_RECONNECT_DELAY</strong> (default: <code>10000</code>): Maximum reconnect delay in milliseconds before attempting to reconnect. Applicable only when reconnect is true.</li>
<li><strong>CONFIG_AMQP_MAX_FRAME_SIZE</strong> (default: <code>4294967295</code>): The largest frame size that the sending peer is able to accept on this connection.</li>
<li><strong>CONFIG_AMQP_NON_FATAL_ERRORS</strong> (default: <code>['amqp:connection:forced']</code>): An array of error conditions which if received on connection close from peer should not prevent reconnect (by default this only includes <code>&quot;amqp:connection:forced&quot;</code>).</li>
<li><strong>CONFIG_AMQP_NON_FATAL_ERRORS</strong> (default: <code>['amqp:connection:forced']</code>): An array of error conditions which if received on connection close from peer should not prevent reconnect (by default this only includes <code>&quot;amqp:connection:forced&quot;</code>).</li>
<li><strong>CONFIG_AMQP_CA_PATH</strong> (default: <code>undefined</code>): The path to the CA certificate file</li>
<li><strong>CONFIG_AMQP_CLIENT_CERT_PATH</strong> (default: <code>undefined</code>): The path to the client certificate file</li>
<li><strong>CONFIG_AMQP_CLIENT_KEY_PATH</strong> (default: <code>undefined</code>): The path to the client key file</li>
<li><strong>CONFIG_AMQP_REQUEST_CERT</strong> (default: <code>false</code>): If true the server will request a certificate from clients that connect and attempt to verify that certificate. Defaults to false.</li>
<li><strong>CONFIG_AMQP_REJECT_UNAUTHORIZED</strong> (default: <code>true</code>): If true the server will reject any connection which is not authorized with the list of supplied CAs. This option only has an effect if requestCert is true.</li>
<li><strong>CONFIG_AMQP_IDLE_TIME_OUT</strong> (default: <code>5000</code>): The maximum period in milliseconds between activity (frames) on the connection that is desired from the peer. The open frame carries the idle-time-out field for this purpose. To avoid spurious timeouts, the value in idle_time_out is set to be half of the peer’s actual timeout threshold.</li>
<li><strong>CONFIG_AMQP_KEEP_ALIVE</strong> (default: <code>true</code>): If true the server will send a keep-alive packet to maintain the connection alive.</li>
<li><strong>CONFIG_AMQP_KEEP_ALIVE_INITIAL_DELAY</strong> (default: <code>2000</code>): The initial delay in milliseconds for the keep-alive packet.</li>
<li><strong>CONFIG_AMQP_TIMEOUT</strong> (default: <code>10000</code>): The time in milliseconds to wait for the connection to be established.</li>
<li><strong>CONFIG_AMQP_ALL_ERRORS_NON_FATAL</strong> (default: <code>true</code>): Determines if rhea's auto-reconnect should attempt reconnection on all fatal errors</li>
<li><strong>NODE_APP_INSTANCE</strong> (default: <code>undefined</code>): Used as default container id, receiver name, sender name, etc. in cluster configurations.</li>
</ul>
<a id="md:license" class="tsd-anchor"></a><h2 class="tsd-anchor-link"><strong>License</strong><a href="#md:license" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Copyright 2024 Mytra Control S.L. All rights reserved.</p>
<p>Use of this source code is governed by an MIT-style license that can be found in the LICENSE file or at <a href="https://opensource.org/licenses/MIT">https://opensource.org/licenses/MIT</a>.</p>
</section><section class="tsd-panel-group tsd-index-group"><section class="tsd-panel tsd-index-panel"><h3 class="tsd-index-heading uppercase">Index</h3><section class="tsd-index-section"><h3 class="tsd-index-heading">Namespaces</h3><div class="tsd-index-list"><a href="_mdf_js_amqp_provider.Receiver.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-4"></use></svg><span>Receiver</span></a>
<a href="_mdf_js_amqp_provider.Sender.html" class="tsd-index-link"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-4"></use></svg><span>Sender</span></a>
</div></section></section></section></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#md:mdfjsamqp-provider"><span>@mdf.js/amqp-<wbr/>provider</span></a><ul><li><a href="#md:table-of-contents"><span>Table of contents</span></a></li><li><a href="#md:introduction"><span>Introduction</span></a></li><li><a href="#md:installation"><span>Installation</span></a></li><li><a href="#md:information"><span>Information</span></a></li><li><a href="#md:use"><span>Use</span></a></li><li><ul><li><a href="#md:health-checks"><span>Health checks</span></a></li></ul></li><li><a href="#md:environment-variables"><span>Environment variables</span></a></li><li><a href="#md:license"><span>License</span></a></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="../index.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-1"></use></svg><span>@mdf.js</span></a><ul class="tsd-small-nested-navigation" id="tsd-nav-container" data-base=".."><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>
